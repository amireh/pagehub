<% content_for(:title) { "Browsability Settings | #{@group.title} | PageHub" } %>

<%= partial "groups/settings/_nav" %>

<form action="<%= request.path %>" method="POST">
  <h2>Browsable Pages</h2>
  <p>Below is a listing of all the pages and folders within your group.
    Unchecking a resource will prevent it from being publicly browsable
    when people are browsing your <a href="<%= @group.public_url%>">group space</a>.
  </p>
  <p><em>Note that this only takes effect if the group is publicly browsable,
    <% if @group.is_browsable? %>which it is. <% else %> which it isn't.<% end %>
  </em></p>
  <ul class="browsability">
    <%
      @group.on_resources({
        on_page: lambda { |p| %>
          <li>
            <label>
              <input type="checkbox" name="browsable[pages][]" value="<%= p.id %>" <%= 'checked="CHECKED"' if p.browsable %> />
              <%= p.title %>
            </label>
          </li>
        <% },

        on_folder: lambda { |f| %>

          <li>
            <label>
              <input type="checkbox" name="browsable[folders][]" value="<%= f.id %>" <%= 'checked="CHECKED"' if f.browsable %> />
              <strong><%= f.title %></strong>
            </label>
          <ol>
        <% },

        on_folder_done: lambda { |f| %>
          </ol></li>
        <% }
      })
    %>
  </ul>

  <% if @group.pages.empty? && @group.folders.empty? %>
    <p class="notice">Oops! The group has no folders or pages yet, nothing to show here.</p>
  <% end %>
  <input type="submit" value="Update" />
</form>