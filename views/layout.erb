<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title><% yield_content :title %></title>
  <!-- <title>notebook.mxvt</title> -->

  <script type="text/javascript" src="/js/jquery.1.7.1.min.js"></script>
  <script type="text/javascript" src="/js/shortcut.js"></script>
  <link href="/css/fonts/proximanova/proximanova.css" rel="stylesheet" type="text/css" />
  <link href="/css/fonts/ubuntu/stylesheet.css" rel="stylesheet" type="text/css" />
  <link href="/css/fonts/ubuntu-mono/stylesheet.css" rel="stylesheet" type="text/css" />
  <link href="/css/common.css" rel="stylesheet" type="text/css" />

  <% if !flash.empty? %>
    <script type="text/javascript">
      marker = null;

      $(function() {
        $("#flashes button").click(function() {
          $(this).parent().next("hr:first").remove();
          $(this).parent().addClass("hidden");
          $(".flash_wrap").addClass("hidden");
        });
      });

    </script>
  <% end %>

  <% if logged_in? then %>
    <style>
      footer { display: none; }
    </style>

    <script>
      pagehub_settings = <%= preferences.to_json %>;

      $(function() {
        ui.theme = "<%= @theme %>";
      });

    </script>

    <script src="/js/pagehub.js"></script>
    <script src="/js/pagehub_ui.js"></script>
    
  <% end %>

  <% yield_content :scripts %>

  <link href="/css/skins/<%= preferences["pagehub"]["skin"] %>.css" rel="stylesheet" type="text/css" />
</head>

<body>

  <div class="header_wrap">
  </div>
  <div class="flash_wrap <%= flash.empty? ? 'hidden' : '' %>">
  </div>

  <% yield_content :wraps %>

  <div class="stuff">
    <header>
      <h1><a href="/">PageHub</a></h1>
    </header>
    
    <nav>
      <% if logged_in? %>
        <div id="admin_actions">
          <a href="/pages/public">public pages</a>
          <a href="/profile">edit profile</a>
          <a href="/logout">logout</a>
        </div>
      <% else %>
        <a id="login" href="/login">login</a>
        <a href="/signup">signup</a>
      <% end %>
    </nav>

    <div id="content">
      <div id="status">
      </div>

      <% if !flash.empty? %>
        <div id="flashes">
          <% if flash.size > 1 then %>
            <ol>
              <% flash.each_pair do |ctx,msg| %>
                <li class="flash <%= ctx %>"><%= msg %></li>
              <% end %>
            </ol>
          <% else %>
            <% flash.each_pair do |ctx,msg| %>
              <span class="flash <%= ctx %>"><%= msg %></span>
            <% end %>
          <% end %>
          <button>&times;</button>
        </div>
      <% end %>

      <%= yield %>
    </div>

    <% if logged_in? %>
      <%= erb(:"_skin_switcher") %>
    <% end %>

  </div>

  <%= erb :"footer" %>
  
</body>

</html>
